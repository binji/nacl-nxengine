VERSION 5.00
Begin VB.Form frmSoundList 
   Caption         =   "Sound List Generator"
   ClientHeight    =   3705
   ClientLeft      =   60
   ClientTop       =   390
   ClientWidth     =   4680
   LinkTopic       =   "Form1"
   ScaleHeight     =   3705
   ScaleWidth      =   4680
   StartUpPosition =   3  'Windows Default
   Begin VB.FileListBox File2 
      Height          =   2040
      Left            =   360
      TabIndex        =   1
      Top             =   720
      Width           =   1215
   End
   Begin VB.FileListBox File1 
      Height          =   1650
      Left            =   1800
      TabIndex        =   0
      Top             =   1560
      Width           =   2295
   End
End
Attribute VB_Name = "frmSoundList"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Sub Form_Load()
Dim deflist$(300)
Dim pxtname$(300)
dfnum = 0

    File1.Path = "c:\dev\nx\soundrip\"
    File2.Path = "c:\dev\nx\pxt\"
    
    File1.Pattern = "*.wav"
    File2.Pattern = "*.pxt"
    
    soundlist$ = ""
    
    For i = 0 To File1.ListCount - 1
        a$ = File1.List(i)
        
        If Left$(a$, 3) = "snd" Then
            num = Val(Mid$(a$, 4, 4))
            If InStr(a$, "_") Then
                descriptor$ = Right$(a$, Len(a$) - InStr(a$, "_"))
                descriptor$ = Left$(descriptor$, InStr(descriptor$, ".") - 1)
                descriptor$ = UCase$(descriptor$)
            Else
                descriptor$ = Trim(Str(num))
            End If
            
            descriptor$ = "SND_" + descriptor$
            
            define$ = "#define " + descriptor$ + Chr(9) + Chr(9) + Trim(Str(num))
            deflist$(dfnum) = define$
            dfnum = dfnum + 1
            
            soundlist$ = soundlist$ + Chr(34) + a$ + Chr(34) + ", " + Trim(Str(num)) + ", " + Chr(13) + Chr(10)
            
            ' find the file name of the sound's pxt
            pxtname$(num) = GetPXTName$(num)
        End If
    Next
    soundlist$ = soundlist$ + "NULL, 0"
    
    ' output the files
    Open "c:\dev\nx\sound.h" For Output As #1
        Print #1, "//automatically generated by SoundList.vbp"
        Print #1, ""
        For i = 0 To dfnum
            Print #1, deflist$(i)
        Next
        Print #1, ""
    Close 1
    
    Open "c:\dev\nx\wavlist.c" For Output As #1
        Print #1, "//automatically generated by SoundList.vbp"
        Print #1, ""
        Print #1, "typedef struct"
        Print #1, "{"
        Print #1, Chr(9) + "const char *fname;"
        Print #1, Chr(9) + "int num;"
        Print #1, "} stWavList;"
        Print #1, ""
        Print #1, "stWavList wav_list[] = {"
        Print #1, soundlist$
        Print #1, "};"
        Print #1, ""
    Close 1
    
    End
End Sub

Function GetPXTName$(num)

    hexnumber$ = UCase$(Right$("0" + Hex(num), 2))
    For i = 0 To File2.ListCount - 1
        f$ = File2.List(i)
        If Left$(f$, 2) = "SE" Then
            k = InStr(f$, ".pxt")
            If k > 2 Then
                k = k - 2
                a$ = Mid$(f$, k, 2)
                If UCase$(a$) = hexnumber$ Then
                    'MsgBox "Got " + f$
                    GetPXTName$ = f$
                    Exit Function
                End If
            End If
        End If
    Next
    
    MsgBox "PXT Not Found: 0x" + hexnumber$
    'End
End Function

